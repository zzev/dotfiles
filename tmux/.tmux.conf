# ==============================================================================
# TMUX Configuration - Optimized for custom Dvorak Layout
# ==============================================================================

# Setting the prefix from `C-b` to `C-a`.
# By remapping the `CapsLock` key to `Ctrl`,
# you can make triggering commands more comfortable!
set -g prefix C-a

# ==============================================================================
# PREFIX AND BASIC SETTINGS
# ==============================================================================

# Free the original `Ctrl-b` prefix keybinding.
unbind C-b

# Set screen default for last window
bind-key C-a last-window

# Allows for faster key repetition
set -s escape-time 0

# Increase scrollback history limit
set -g history-limit 50000

# Enable mouse support
set -g mouse on

# Rather than constraining window size to the maximum size of any client
# connected to the *session*, constrain window size to the maximum size of any
# client connected to *that window*. Much more reasonable.
setw -g aggressive-resize on

# Allows us to use C-a a <command> to send commands to a TMUX session inside
# another TMUX session
bind-key a send-prefix

# ==============================================================================
# COPY MODE AND CLIPBOARD
# ==============================================================================

# Vi copypaste mode
set-window-option -g mode-keys vi

# Enhanced copy mode
bind-key [ copy-mode
bind-key ] paste-buffer
bind-key p paste-buffer

# Vi-style copy mode bindings
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Copy to system clipboard (requires xclip or xsel)
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# Mouse copy mode
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# Copy mode navigation with rtns
bind-key -T copy-mode-vi r send-keys -X cursor-left
bind-key -T copy-mode-vi t send-keys -X cursor-down
bind-key -T copy-mode-vi n send-keys -X cursor-up
bind-key -T copy-mode-vi s send-keys -X cursor-right

# ==============================================================================
# PANE NAVIGATION AND MANAGEMENT (Dvorak optimized)
# ==============================================================================

# rtns pane traversal (Dvorak layout with r/h swap)
bind r select-pane -L
bind t select-pane -D
bind n select-pane -U
bind s select-pane -R

# Pane resizing with rtns (repeatable)
bind -r R resize-pane -L 5
bind -r T resize-pane -D 5
bind -r N resize-pane -U 5
bind -r S resize-pane -R 5

# Pane management
bind x kill-pane
bind X kill-window
bind q display-panes
bind o rotate-window
bind Space next-layout
bind-key '{' swap-pane -U
bind-key '}' swap-pane -D

# Pane synchronization toggle
bind e setw synchronize-panes

# ==============================================================================
# WINDOW AND PANE CREATION
# ==============================================================================

# Splitting panes.
#bind | split-window -h
#bind - split-window -v

bind c new-window -c "#{b:pane_current_path}"
bind '-' split-window -c "#{b:pane_current_path}"
bind '|' split-window -h -c "#{b:pane_current_path}"
# bind C new-window
# bind '_' split-window
# bind '/' split-window -h

# Window management
bind-key , command-prompt -p "rename window to:" "rename-window '%%'"
bind-key . command-prompt "move-window -t '%%'"
bind-key -r < swap-window -t -1
bind-key -r > swap-window -t +1
bind-key W choose-window
bind-key w list-windows

# ==============================================================================
# WINDOW MANAGEMENT
# ==============================================================================

# Quick window navigation
bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6
bind-key -n M-7 select-window -t 7
bind-key -n M-8 select-window -t 8
bind-key -n M-9 select-window -t 9

# ==============================================================================
# SESSION MANAGEMENT AND UTILITIES
# ==============================================================================

# Reload the file with Prefix y.
bind y source-file ~/.tmux.conf \; display "Reloaded!"

# Session management
bind-key S choose-session
bind-key L list-sessions
bind-key $ command-prompt -p "rename session to:" "rename-session '%%'"
bind-key N command-prompt -p "new session name:" "new-session -d -s '%%'"
bind-key K confirm-before -p "kill-session #S? (y/n)" kill-session

# ==============================================================================
# TERMINAL AND PERFORMANCE SETTINGS
# ==============================================================================

# auto window rename
set-window-option -g automatic-rename
#set-option -g allow-rename on

# Set the default terminal mode to 256color mode.
#set -g default-terminal "screen-256color"
set -g default-terminal "xterm-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# Performance and compatibility improvements
set -g focus-events on
set -g set-clipboard on
set -g renumber-windows on
set -g base-index 1
setw -g pane-base-index 1
set -g display-time 2000
set -g display-panes-time 3000
set -g repeat-time 500

# Activity monitoring
setw -g monitor-activity on
#set -g visual-activity on

# Productivity features
# Quick command line access
bind-key : command-prompt

# Toggle status line visibility
bind-key b set-option status

# Clear history
bind-key C-l clear-history

# Zoom pane toggle (already available with C-a z, but adding shortcut)
bind-key z resize-pane -Z

# Display time
bind-key T clock-mode

# Find window
bind-key f command-prompt "find-window '%%'"

# Join pane from another window
bind-key J command-prompt -p "join pane from:" "join-pane -s '%%'"

# Break pane to new window
bind-key B break-pane

# Repeat last command
bind-key m last-window
bind-key M previous-window

# ==============================================================================
# STATUS LINE AND COLORS
# ==============================================================================

set -g status-interval 1
set -g status-justify centre # center align window list
set -g status-left-length 20
set -g status-right-length 140
set -g status-left '#[fg=green]#H #[fg=black]â€¢ '
set -g status-right '#[fg=white,bg=default]%a %l:%M:%S %p#[default] #[fg=default]%Y-%m-%d'

# Solarized colors ...

# default statusbar colors
set-option -g status-style bg=colour235,fg=colour136
#set-option -g status-style default

# default window title colors
set-window-option -g window-status-style fg=colour244
#set-window-option -ag window-status-style bg=default
#set-window-option -ag window-status-style dim

# active window title colors
set-window-option -g window-status-current-style fg=colour166 #orange
#set-window-option -ag window-status-current-style bg=default
#set-window-option -ag window-status-current-style bright

# pane border
set-option -g pane-border-style fg=colour235
set-option -g pane-active-border-style fg=colour240

# message text
set-option -g message-style bg=colour235,fg=colour166

# pane number display
set-option -g display-panes-active-colour colour33 #blue
set-option -g display-panes-colour colour166 #orange

# clock
set-window-option -g clock-mode-colour colour64 #green
set-window-option -g clock-mode-style 24

# ==============================================================================
# KEY BINDINGS REFERENCE (Dvorak Layout)
# ==============================================================================
# Navigation: r(left) t(down) n(up) s(right)
# Resize: R T N S (with repeat)
# Windows: Alt+1-9 (quick switch), ,=rename .=move <=prev >=next
# Sessions: S=choose L=list $=rename N=new K=kill
# Copy: [ ] p, v=select y=copy (to clipboard)
# Other: e=sync-panes z=zoom b=toggle-status y=reload
# ==============================================================================
